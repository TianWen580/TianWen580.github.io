---

## title: Pytorch·GPU 训练(单/多)date: 2021-08-07 23:20:37

tags: [深度学习, 语义分割, Pytorch]
categories: 计算机视觉特辑

在一切开始前，请确定计算机拥有英伟达的显卡。

（不是英特尔！不是英特尔！不是英特尔！）
CUDA 安装参考该笔记：Keras·GPU 训练（单/多）

1.依赖库版本：

• Torch

• Torchvision

2.安装 PyTorch：

• 进入 PyTorch 官网 Start Locally | PyTorch 选择版本，在 conda 运行所给安装语句

![](Pytorch%C2%B7GPU%E8%AE%AD%E7%BB%83-%E5%8D%95-%E5%A4%9A/%E5%9B%BE1.png#alt=%E5%9B%BE1)

• 然后参照 Keras 的 gpu 环境配置，安装 CUDA11.1 和对应的 cudnn。

3.单 gpu 训练

• 输入如下语句，指定搜索 gpu 的起始位置

device=torch.device("cuda:0"iftorch.cuda.is_available()else"cpu")

4.多 gpu 训练

• Torch.nn.DataParallel

○ 输入如下语句，指定搜索 gpu 的起始位置

device=torch.device("cuda:0"iftorch.cuda.is_available()else"cpu")

○ 输入如下语句生成多 gpu 的 model

Par_model = nn.DataParallel(MyNet())

Par_model = Par_model.cuda(device)   #model 加载到 gpu
